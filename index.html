<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MiSize - Size Finder & Body Tracker</title>
  <style>
    :root {
      --brand: #8A2BE2;
      --bg: #0b0d12;
      --card: #111520;
      --border: #1b2230;
      --text: #eef1f5;
      --muted: #aab3c5;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, sans-serif;
      background: var(--bg);
      color: var(--text);
    }
    .topbar {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(15, 19, 26, .75);
      border-bottom: 1px solid var(--border);
      padding: 6px 8px;
    }
    .topbar-inner {
      display: flex;
      gap: 8px;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
    }
    .topbar h1 {
      font-size: 14px;
      margin: 0 6px 0 0;
      font-weight: 800;
      color: #cfe0ff;
    }
    .pill-row {
      display: flex;
      gap: 6px;
      align-items: center;
      flex-wrap: wrap;
    }
    .pill, .unit-pill, .pt-pill {
      border: 1px solid rgba(255, 255, 255, .12);
      background: #151a3a;
      color: #c9d3ea;
      font-weight: 700;
      font-size: 10px;
      padding: 4px 8px;
      border-radius: 999px;
      cursor: pointer;
    }
    .pill.active, .unit-pill.active, .pt-pill.active {
      background: #1d4ed8;
      color: #fff;
    }
    .screen {
      display: none;
      padding: 20px 20px 90px;
      background: #2b1055;
      min-height: 100vh;
    }
    .screen.active { display: block; }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 18px;
    }
    .row {
      display: grid;
      gap: 12px;
    }
    @media (min-width: 760px) {
      .row.two { grid-template-columns: 1fr 1fr; }
      .row.three { grid-template-columns: repeat(3, 1fr); }
    }
    label {
      font-size: 14px;
      color: var(--muted);
      display: block;
      margin-bottom: 4px;
    }
    select, input {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid #243048;
      background: #0f131a;
      color: #eef1f5;
    }
    .toolbar {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    .big {
      font-size: 28px;
      font-weight: 800;
      margin: 0 0 6px;
    }
    .note {
      font-size: 13px;
      opacity: .85;
      color: var(--muted);
    }
    .success { color: #8ee0b2; }
    .warning { color: #ffd27a; }
    .danger { color: #ff9a9a; }
    .tiles {
      display: grid;
      gap: 16px;
      height: calc(100vh - 210px);
      margin-top: 20px;
    }
    .tiles button {
      font-size: 28px;
      font-weight: 800;
      border-radius: 14px;
      border: 0;
      color: #fff;
      cursor: pointer;
      background: #1d4ed8;
    }
    .bottom-tabs {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      background: #0f131a;
      border-top: 1px solid var(--border);
      display: flex;
      z-index: 30;
    }
    .bottom-tabs .tab {
      flex: 1;
      padding: 12px 8px;
      border: 0;
      background: transparent;
      color: #cfd7ea;
      font-weight: 700;
      cursor: pointer;
    }
    .bottom-tabs .tab.active {
      color: var(--brand);
    }
    .mi-tile {
      background: #0f131a;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      text-align: center;
    }
    .mi-v {
      font-size: 24px;
      font-weight: 900;
      margin: 8px 0;
    }
    .mi-l {
      font-size: 12px;
      color: var(--muted);
    }
  </style>
</head>
<body>
  <!-- Top Bar -->
  <div class="topbar">
    <div class="topbar-inner">
      <h1>MiSize</h1>
      <div class="pill-row" id="bodyTypePills">
        <button class="pt-pill active" data-val="standard">Standard</button>
        <button class="pt-pill" data-val="petite">Petite</button>
        <button class="pt-pill" data-val="tall">Tall</button>
        <button class="pt-pill" data-val="plus">Plus-size</button>
      </div>
      <div style="flex:1;"></div>
      <div class="pill-row" id="unitPills">
        <button class="unit-pill active" data-unit="cm">cm</button>
        <button class="unit-pill" data-unit="in">inches</button>
      </div>
    </div>
  </div>

  <!-- Home -->
  <section id="home" class="screen active">
    <h1 class="big">Welcome to MiSize</h1>
    <p>Your personal size finder and body tracker.</p>
    <div class="tiles">
      <button onclick="switchTab('sizefinder')">Size Finder</button>
      <button onclick="switchTab('mistats')">MiStats Tracker</button>
      <button onclick="switchTab('profile')">My Profile</button>
      <button onclick="switchTab('settings')">Settings</button>
    </div>
  </section>

  <!-- Size Finder -->
  <section id="sizefinder" class="screen">
    <div class="card">
      <h2 class="big">Size Finder</h2>
      <div class="row two">
        <div>
          <label for="sf_brand">Brand</label>
          <select id="sf_brand">
            <option value="primark">Primark</option>
            <option value="next">Next</option>
            <option value="ms">M&S</option>
            <option value="zara">Zara</option>
            <option value="hm">H&M</option>
          </select>
        </div>
        <div>
          <label for="sf_category">Category</label>
          <select id="sf_category">
            <option value="dress">Dress</option>
            <option value="jeans">Jeans</option>
            <option value="top">Top</option>
          </select>
        </div>
      </div>
      <div class="toolbar">
        <button class="pill" onclick="findSize()">Find My Size</button>
      </div>
      <div id="size_result" style="margin-top: 16px;"></div>
    </div>
  </section>

  <!-- Profile -->
  <section id="profile" class="screen">
    <div class="card">
      <h2 class="big">My Profile</h2>
      <div class="row three">
        <div>
          <label for="height">Height (cm)</label>
          <input id="height" placeholder="e.g., 168">
        </div>
        <div>
          <label for="bust">Bust (cm)</label>
          <input id="bust" placeholder="e.g., 88">
        </div>
        <div>
          <label for="waist">Waist (cm)</label>
          <input id="waist" placeholder="e.g., 70">
        </div>
        <div>
          <label for="hip">Hip (cm)</label>
          <input id="hip" placeholder="e.g., 94">
        </div>
        <div>
          <label for="weight">Weight (kg)</label>
          <input id="weight" placeholder="e.g., 65">
        </div>
      </div>
      <div class="toolbar">
        <button class="pill" onclick="saveProfile()">Save Profile</button>
      </div>
    </div>
  </section>

  <!-- MiStats -->
  <section id="mistats" class="screen">
    <div class="card">
      <h2 class="big">MiStats</h2>
      <p class="note">Track your progress over time.</p>
      
      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin: 20px 0;">
        <div class="mi-tile">
          <div class="mi-l">Current Weight</div>
          <div class="mi-v" id="current_weight">—</div>
        </div>
        <div class="mi-tile">
          <div class="mi-l">Current Bust</div>
          <div class="mi-v" id="current_bust">—</div>
        </div>
        <div class="mi-tile">
          <div class="mi-l">Current Waist</div>
          <div class="mi-v" id="current_waist">—</div>
        </div>
      </div>

      <div class="row three">
        <div>
          <label for="new_weight">Add Weight Entry</label>
          <input id="new_weight" placeholder="Weight in kg">
        </div>
        <div>
          <label for="entry_date">Date</label>
          <input id="entry_date" type="date">
        </div>
        <div style="display: flex; align-items: flex-end;">
          <button class="pill" onclick="addEntry()">Add Entry</button>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>Recent Entries</h3>
      <div id="entries_list">
        <div class="note">No entries yet. Add your first measurement above.</div>
      </div>
    </div>
  </section>

  <!-- Settings -->
  <section id="settings" class="screen">
    <div class="card">
      <h2 class="big">Settings</h2>
      <div class="card">
        <h3>Units</h3>
        <div class="pill-row">
          <button class="pill active" onclick="setUnit('metric')">Metric (cm/kg)</button>
          <button class="pill" onclick="setUnit('imperial')">Imperial (in/lb)</button>
        </div>
      </div>
      
      <div class="card">
        <h3>Body Type</h3>
        <div class="pill-row">
          <button class="pill active" onclick="setBodyType('standard')">Standard</button>
          <button class="pill" onclick="setBodyType('petite')">Petite</button>
          <button class="pill" onclick="setBodyType('tall')">Tall</button>
          <button class="pill" onclick="setBodyType('plus')">Plus Size</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Bottom Navigation -->
  <div class="bottom-tabs">
    <button id="tab_home" class="tab active" onclick="switchTab('home')">Home</button>
    <button id="tab_back" class="tab" onclick="goBack()" style="display:none;">Back</button>
    <button id="tab_mistats" class="tab" onclick="switchTab('mistats')">MiStats</button>
    <button id="tab_settings" class="tab" onclick="switchTab('settings')">Settings</button>
  </div>

  <script>
    // Global variables
    let currentProfile = {
      height: 168,
      bust: 88,
      waist: 70,
      hip: 94,
      weight: 65
    };
    let entries = [];
    let navStack = [];
    let currentScreen = 'home';

    // Size database (simplified)
    const sizeData = {
      primark: {
        dress: [
          { size: '8', bust: 84, waist: 66, hip: 90 },
          { size: '10', bust: 88, waist: 70, hip: 94 },
          { size: '12', bust: 92, waist: 74, hip: 98 },
          { size: '14', bust: 96, waist: 78, hip: 102 }
        ]
      },
      next: {
        dress: [
          { size: '8', bust: 83, waist: 65, hip: 89 },
          { size: '10', bust: 87, waist: 69, hip: 93 },
          { size: '12', bust: 91, waist: 73, hip: 97 },
          { size: '14', bust: 95, waist: 77, hip: 101 }
        ]
      }
    };

    // Navigation
    function switchTab(tab) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      
      document.getElementById(tab).classList.add('active');
      document.getElementById('tab_' + tab)?.classList.add('active');
      
      currentScreen = tab;
      updateBackButton();
      
      if (tab === 'mistats') updateMiStats();
      if (tab === 'profile') loadProfile();
    }

    function goBack() {
      if (navStack.length > 0) {
        const prevScreen = navStack.pop();
        switchTab(prevScreen);
      } else {
        switchTab('home');
      }
    }

    function updateBackButton() {
      const backBtn = document.getElementById('tab_back');
      const topLevel = ['home', 'mistats', 'profile', 'settings'];
      if (backBtn) {
        backBtn.style.display = topLevel.includes(currentScreen) ? 'none' : 'inline-block';
      }
    }

    // Size finder
    function findSize() {
      const brand = document.getElementById('sf_brand').value;
      const category = document.getElementById('sf_category').value;
      
      if (!sizeData[brand] || !sizeData[brand][category]) {
        document.getElementById('size_result').innerHTML = 
          '<div class="card"><p class="note">Size data not available for this combination.</p></div>';
        return;
      }
      
      const sizes = sizeData[brand][category];
      let bestMatch = null;
      let smallestDiff = Infinity;
      
      sizes.forEach(size => {
        const diff = Math.abs(size.bust - currentProfile.bust) + 
                    Math.abs(size.waist - currentProfile.waist) + 
                    Math.abs(size.hip - currentProfile.hip);
        
        if (diff < smallestDiff) {
          smallestDiff = diff;
          bestMatch = size;
        }
      });
      
      if (bestMatch) {
        const confidence = smallestDiff < 5 ? 'High' : smallestDiff < 10 ? 'Medium' : 'Low';
        const confClass = confidence === 'High' ? 'success' : confidence === 'Medium' ? 'warning' : 'danger';
        
        document.getElementById('size_result').innerHTML = `
          <div class="card">
            <h3>Recommended Size: <span style="font-size: 32px; color: #1d4ed8;">${bestMatch.size}</span></h3>
            <p>Confidence: <span class="${confClass}">${confidence}</span></p>
            <div class="note">
              <p>Based on: Bust ${bestMatch.bust}cm, Waist ${bestMatch.waist}cm, Hip ${bestMatch.hip}cm</p>
              <p>Your measurements: Bust ${currentProfile.bust}cm, Waist ${currentProfile.waist}cm, Hip ${currentProfile.hip}cm</p>
            </div>
          </div>
        `;
      }
    }

    // Profile management
    function saveProfile() {
      currentProfile.height = parseFloat(document.getElementById('height').value) || currentProfile.height;
      currentProfile.bust = parseFloat(document.getElementById('bust').value) || currentProfile.bust;
      currentProfile.waist = parseFloat(document.getElementById('waist').value) || currentProfile.waist;
      currentProfile.hip = parseFloat(document.getElementById('hip').value) || currentProfile.hip;
      currentProfile.weight = parseFloat(document.getElementById('weight').value) || currentProfile.weight;
      
      localStorage.setItem('misize_profile', JSON.stringify(currentProfile));
      alert('Profile saved!');
      updateMiStats();
    }

    function loadProfile() {
      const saved = localStorage.getItem('misize_profile');
      if (saved) {
        currentProfile = JSON.parse(saved);
      }
      
      document.getElementById('height').value = currentProfile.height;
      document.getElementById('bust').value = currentProfile.bust;
      document.getElementById('waist').value = currentProfile.waist;
      document.getElementById('hip').value = currentProfile.hip;
      document.getElementById('weight').value = currentProfile.weight;
    }

    // MiStats
    function addEntry() {
      const weight = parseFloat(document.getElementById('new_weight').value);
      const date = document.getElementById('entry_date').value;
      
      if (!weight || !date) {
        alert('Please enter both weight and date');
        return;
      }
      
      entries.unshift({
        weight: weight,
        date: date,
        bust: currentProfile.bust,
        waist: currentProfile.waist,
        hip: currentProfile.hip
      });
      
      localStorage.setItem('misize_entries', JSON.stringify(entries));
      
      document.getElementById('new_weight').value = '';
      document.getElementById('entry_date').value = '';
      
      updateMiStats();
    }

    function updateMiStats() {
      const saved = localStorage.getItem('misize_entries');
      if (saved) {
        entries = JSON.parse(saved);
      }
      
      document.getElementById('current_weight').textContent = currentProfile.weight + ' kg';
      document.getElementById('current_bust').textContent = currentProfile.bust + ' cm';
      document.getElementById('current_waist').textContent = currentProfile.waist + ' cm';
      
      const entriesList = document.getElementById('entries_list');
      if (entries.length === 0) {
        entriesList.innerHTML = '<div class="note">No entries yet. Add your first measurement above.</div>';
      } else {
        entriesList.innerHTML = entries.map(entry => `
          <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div>
                <strong>${entry.date}</strong>
                <div class="note">Weight: ${entry.weight}kg, Bust: ${entry.bust}cm, Waist: ${entry.waist}cm</div>
              </div>
            </div>
          </div>
        `).join('');
      }
    }

    // Settings
    function setUnit(unit) {
      document.querySelectorAll('.pill').forEach(p => p.classList.remove('active'));
      event.target.classList.add('active');
      // Unit conversion would go here
    }

    function setBodyType(type) {
      document.querySelectorAll('.pill').forEach(p => p.classList.remove('active'));
      event.target.classList.add('active');
      // Body type logic would go here
    }

    // Initialize
    window.addEventListener('load', () => {
      loadProfile();
      updateMiStats();
      
      // Set today's date
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('entry_date').value = today;
    });
  </script>
</body>
</html>
